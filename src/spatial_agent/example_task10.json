{
    "workflow_name": "Calculate Renewal Potential Index",
    "task_statement": "基于建设年龄（高潜力）和容积率（低潜力）生成地块更新潜力指数。",
    "arcgis_context": { "workspace": "project.gdb", "coordinate_system": "projected", "linear_unit": "meters", "area_unit": "square_meters" },
    "inputs": [
        { "layer_name": "parcel", "geometry_type": "polygon", "required_fields": ["parcel_id", "parcel_area", "built_year"] },
        { "layer_name": "building", "geometry_type": "polygon", "required_fields": ["building_area", "story"] }
    ],
    "steps": [
        {
            "step_id": "S1",
            "tool": "Spatial Join",
            "purpose": "计算地块总建筑面积",
            "parameters": {
                "target_features": "parcel",
                "join_features": "building",
                "join_operation": "JOIN_ONE_TO_ONE",
                "match_option": "HAVE_THEIR_CENTER_IN",
                "summary_fields": [{"field": "building_area", "statistic": "SUM", "out_field": "total_base_area"}]
            },
            "inputs": [{"source": "input", "layer_name": "parcel"}, {"source": "input", "layer_name": "building"}],
            "outputs": [{ "name": "parcel_with_bldg_sum", "type": "feature_class", "geometry_type": "polygon", "new_fields": ["total_base_area"], "path_hint": "project.gdb/parcel_with_bldg_sum" }],
            "qc_checks": []
        },
        {
            "step_id": "S2",
            "tool": "Calculate Field",
            "purpose": "计算综合潜力指数",
            "parameters": {
                "field": "potential_index",
                "expression": "(2026 - !built_year!) + (1 / (!total_base_area! / !parcel_area!))",
                "expression_type": "PYTHON3"
            },
            "inputs": [{"source": "step_output", "layer_name": "S1.parcel_with_bldg_sum"}],
            "outputs": [{ "name": "parcel_potential", "type": "feature_class", "geometry_type": "polygon", "new_fields": ["potential_index"], "path_hint": "project.gdb/parcel_potential" }],
            "qc_checks": []
        }
    ],
    "outputs": [{ "name": "parcel_potential", "type": "feature_class", "geometry_type": "polygon", "fields": ["parcel_id", "potential_index"], "description": "地块更新潜力分值" }],
    "assumptions": ["2026为当前基准年", "容积率不为0"]
}