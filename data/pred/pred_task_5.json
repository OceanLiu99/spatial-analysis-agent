{
    "workflow_name": "Chicago_Metro_Station_Density_Analysis",
    "task_statement": "Select the community with the highest number of metro stations in Chicago.",
    "arcgis_context": {
        "workspace": "project.gdb",
        "coordinate_system": "NAD 1983 StatePlane Illinois East FIPS 1201 (US Feet)",
        "linear_unit": "Feet",
        "area_unit": "SquareFeet"
    },
    "inputs": [
        {
            "layer_name": "chicago_communities",
            "geometry_type": "Polygon",
            "required_fields": [
                "community_name",
                "area_num"
            ],
            "optional_fields": [],
            "notes": "Boundary data for Chicago community areas."
        },
        {
            "layer_name": "metro_stations",
            "geometry_type": "Point",
            "required_fields": [
                "station_name"
            ],
            "optional_fields": [],
            "notes": "Point locations of metro (L) stations in Chicago."
        }
    ],
    "steps": [
        {
            "step_id": "S1",
            "tool": "Spatial Join",
            "purpose": "Count the number of metro stations within each community area.",
            "parameters": {
                "target_features": "chicago_communities",
                "join_features": "metro_stations",
                "join_operation": "JOIN_ONE_TO_ONE",
                "join_type": "KEEP_ALL",
                "match_option": "COMPLETELY_CONTAINS"
            },
            "inputs": [
                {
                    "source": "user_input",
                    "layer_name": "chicago_communities"
                },
                {
                    "source": "user_input",
                    "layer_name": "metro_stations"
                }
            ],
            "outputs": [
                {
                    "name": "communities_station_count",
                    "type": "Feature Class",
                    "geometry_type": "Polygon",
                    "new_fields": [
                        "Join_Count"
                    ],
                    "path_hint": "project.gdb/communities_station_count"
                }
            ],
            "qc_checks": [
                {
                    "check": "Verify station count field",
                    "how": "Check if 'Join_Count' field exists and contains non-negative integers.",
                    "pass_condition": "Field exists and max value > 0"
                },
                {
                    "check": "Total station consistency",
                    "how": "Sum the 'Join_Count' field and compare with total metro_stations count.",
                    "pass_condition": "Sum(Join_Count) <= Total Metro Stations"
                }
            ]
        },
        {
            "step_id": "S2",
            "tool": "Select features using attributes",
            "purpose": "Identify the community with the maximum number of stations.",
            "parameters": {
                "in_layer_or_view": "S1.communities_station_count",
                "selection_type": "NEW_SELECTION",
                "where_clause": "Join_Count = (SELECT MAX(Join_Count) FROM communities_station_count)"
            },
            "inputs": [
                {
                    "source": "S1",
                    "layer_name": "communities_station_count"
                }
            ],
            "outputs": [
                {
                    "name": "top_metro_community",
                    "type": "Feature Layer",
                    "geometry_type": "Polygon",
                    "new_fields": [],
                    "path_hint": "project.gdb/top_metro_community"
                }
            ],
            "qc_checks": [
                {
                    "check": "Selection result",
                    "how": "Count the number of selected features.",
                    "pass_condition": "Count >= 1"
                }
            ]
        }
    ],
    "outputs": [
        {
            "name": "top_metro_community",
            "type": "Feature Class",
            "geometry_type": "Polygon",
            "fields": [
                "community_name",
                "Join_Count"
            ],
            "description": "The Chicago community area containing the highest number of metro stations."
        }
    ],
    "assumptions": [
        "The metro stations are represented as points and fall strictly within the community boundaries.",
        "The 'Join_Count' field generated by Spatial Join correctly represents the count of stations.",
        "The coordinate systems of both input layers are compatible for spatial analysis."
    ]
}